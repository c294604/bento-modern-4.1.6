/**
 * Bento v4.1.3
 * Built on: 2024-10-17T19:49:16
 * Copyright 2024 Thomson Reuters
 * Maintained by Chi Gao, Joe Huang, Aaron Mendez
 */
!function(){"use strict";function a(a,b,c,d,e){function f(f,g,h){function i(){if(f.data){var a=f.data.yAxis&&f.data.yAxis.categories||f.data.series[0].data.map(function(a){return a.name}),b=e.getD3Data(f.data,"y");d3.select(g[0]).select("svg").remove(),o=d3.select(g[0]).append("svg").attr("width","100%").attr("height",s.chart.height+s.chart.marginTop+s.chart.marginBottom).append("g");var c=d3.scaleLinear(),h=d3.max(f.data.series,function(a){return"object"==typeof a.data[0]?d3.max(a.data,function(a){return a.x}):d3.max(a.data)}),i=d3.min(f.data.series,function(a){return"object"==typeof a.data[0]?d3.min(a.data,function(a){return a.x}):d3.min(a.data)});i=i>0?0:i+.1*i,h=h<0?0:h+.1*h;var k=e.flattenObject(s);k.colors&&(t=d3.scaleOrdinal().range(s.colors)),k["plotOptions.series.stacking"]||k["plotOptions.bar.stacking"]?(i=0,h=d3.max(b,function(a){return a.total}),c.domain([h,i]).nice().range([s.chart.width,0])):c.domain([h,i]).nice().range([s.chart.width,0]);var l=d3.axisBottom(c);k["xAxis.labels.formatter"]&&l.tickFormat(k["xAxis.labels.formatter"]);var m=o.append("g").attr("shape-rendering","crispEdges").attr("transform","translate(0,"+s.chart.height+")").attr("class","x axis").call(l),n=0,p=m.selectAll("text");if(k["xAxis.labels.style.fontSize"]&&p.attr("font-size",k["xAxis.labels.style.fontSize"]),k["xAxis.labels.rotation"]&&o.selectAll(".x.axis text").attr("transform",function(){return"translate("+this.getBBox().height*-.5+","+.5*this.getBBox().height+")rotate("+k["xAxis.labels.rotation"]+" 0,0)"}).style("text-anchor","end").attr("x",0).attr("y",0),p.each(function(){this.getBBox().height>n&&(n=this.getBoundingClientRect().height)}),k["xAxis.title.text"]){var q=m.append("text").attr("x",s.chart.width/2).style("text-anchor","middle").text(k["xAxis.title.text"]);n=n+q.node().getBoundingClientRect().height+10,q.attr("dy",n)}o.attr("transform","translate("+s.chart.marginLeft+","+s.chart.marginTop+")");var r=b.length>1?k["plotOptions.series.groupPadding"]:0,v=k["plotOptions.series.pointPadding"],w=d3.scaleBand().range([0,s.chart.height]).padding(r).round(!0),x=d3.scaleBand(),y=d3.axisLeft(w);k["yAxis.labels.formatter"]&&y.tickFormat(k["yAxis.labels.formatter"]),b.length>1?y.scale(w):y.scale(x),w.domain(b.map(function(a){return a.name})),x.domain(a).range([0,w.bandwidth()]).padding(v).round(!0),o.selectAll("line.vertical-grid").data(c.ticks()).enter().append("line").attr("class","vertical-grid").attr("y1",0).attr("y2",s.chart.height).attr("x1",function(a){return c(a)}).attr("x2",function(a){return c(a)}).style("stroke","#000").style("stroke-opacity","0.1");var z=o.selectAll(".col").data(b).enter().append("g").attr("class",".col").attr("transform",function(a){return"translate(0,"+w(a.name)+")"}),A=k["tooltip.formatter"],B=z.selectAll(".bar").data(function(a){return a.barData}).enter().append("rect").on("mouseover",function(a){e.onMouseMove(a,this,g[0],u,A)}).on("mousemove",function(a){e.onMouseMove(a,this,g[0],u,A)}).on("mouseout",function(){e.onMouseOut(u)}).attr("class","bar");k["plotOptions.series.stacking"]||k["plotOptions.bar.stacking"]?(y.scale(w),B.attr("height",w.bandwidth()).attr("fill",j).attr("width",0).attr("x",function(a){return c(0)}).transition().duration(1e3).attr("width",function(a){return c(a.x1)-c(a.x0)}).attr("x",function(a){return c(a.x0)})):B.attr("y",function(a){return x(a.name)}).attr("height",x.bandwidth()).attr("fill",j).attr("width",0).attr("x",function(a){return c(0)}).transition().duration(1e3).attr("x",function(a){return c(a.value>0?0:a.value)}).attr("width",function(a){return Math.abs(c(a.value)-c(0))});var C=o.append("g").attr("class","y axis").attr("shape-rendering","crispEdges").call(y);k["yAxis.labels.style.fontSize"]&&o.selectAll(".y.axis text").attr("font-size",k["yAxis.labels.style.fontSize"]);var D=0,E=C.selectAll("text");if(k["yAxis.labels.style.fontSize"]&&E.attr("font-size",k["yAxis.labels.style.fontSize"]),E.each(function(){this.getBBox().width>D&&(D=this.getBBox().width)}),k["yAxis.title.text"]){var F=C.append("text").attr("transform","rotate(-90)").attr("x",-s.chart.height/2).style("text-anchor","middle").text(k["yAxis.title.text"]);D=-D-F.node().getBBox().height-2,F.attr("dy",D)}if(0!=i&&o.append("g").append("line").attr("class","y axis").attr("x1",c(0)).attr("x2",c(0)).attr("y2",s.chart.height),0!=k["legend.enabled"]&&(b.length>1||k["plotOptions.series.stacking"]||k["plotOptions.bar.stacking"])){var G;G=o.selectAll(".legend").data(a.slice()).enter().append("g").attr("class","legend").attr("transform",function(a,b){return"translate(0,"+19*b+")"}),G.append("rect").attr("x",s.chart.width-15+s.chart.marginRight).attr("width",15).attr("height",15).style("fill",t),G.append("text").attr("x",s.chart.width-21+s.chart.marginRight).attr("y",9).attr("dy",".15em").style("text-anchor","end").text(function(a){return a})}d.isRTL()===!0&&e.makeRTL(g,o,k,s,q,F,E,G,n,D)}}function j(a){return a.color?a.color:t(a.name)}function k(a,b){a&&a.series&&m()}function l(){f.$apply()}function m(a){p&&c.cancel(p),p=c(function(){s.chart.width=g[0].offsetWidth-s.chart.marginLeft-s.chart.marginRight,s.chart.width<0&&(s.chart.width=0),i()},500)}function n(){angular.element(b).off("resize",l),d3.select(g[0]).select("svg").remove()}var o,p,q=angular.copy(e.defaultOptions),r=angular.copy(f.data),s=angular.merge(q,r),t=a.brand10();f.$watch("data",k,!0),f.$on("$destroy",n),g.on("$destroy",n),angular.element(b).on("resize",l),f.$watch(function(){return g[0].offsetWidth},m);var u=e.tooltipID(),v=e.tooltipHTML(u);g.append(v)}return{restrict:"EA",scope:{data:"="},link:f}}angular.module("bento.d3").directive("bentoD3BarChart",a),a.$inject=["bentoD3Config","$window","$timeout","$bentoServices","bentoChartService"]}();