/**
 * Bento v4.1.6
 * Built on: 2024-11-14T22:21:54
 * Copyright 2024 Thomson Reuters
 * Maintained by Chi Gao, Joe Huang, Aaron Mendez
 */
!function(){"use strict";function a(a,b,c,d,e,f,g){function h(b,c,d,g){function h(a){a&&a.series&&a.series[0].data&&(D=!0,o())}function i(a){return a.color?a.color:v(a.name)}function j(){d3.select(c[0]).select("svg").remove(),x=d3.select(c[0]).append("svg").attr("width",t.chart.width).attr("height",t.chart.height).attr("class","bento-d3-bubbles"),C=d3.scalePoint().domain(d3.range(A)).range([0,t.chart.width],1),w=angular.copy(b.data.series[0].data),u.nodes=w;var a=d3.min(w,function(a){return parseInt(a.value)}),d=d3.max(w,function(a){return parseInt(a.value)});z=d3.scaleLinear().domain([a,d]).range([t.chart.radius.min,t.chart.radius.max]),w.forEach(function(a,b){var c=Math.floor(Math.random()*A);(c+1)/A*-Math.log(Math.random());a.cx=C(c),a.cy=t.chart.height/2,a[0]=0,a[1]=0,a.count=a.value,a.value=z(a.value),a.name=a.name,a.id=Math.random().toString(36).substr(2,9)}),r=d3.forceSimulation().nodes(w).force("x",d3.forceX().strength(0)).force("y",d3.forceY().strength(0)).force("center",d3.forceCenter(t.chart.width/2,t.chart.height/2)).on("tick",k),y=x.selectAll("g").data(w).enter().append("g").attr("id",function(a){return"node"+a.id}).attr("class","node").attr("cx",function(a){return a.cx}).attr("cy",function(a){return a.cy}).attr("transform",function(a){return"translate("+a[0]+","+a[1]+")"});y.append("circle").attr("class",function(a){return"bubble "+(a.type?a.type:"")}).attr("fill",i).attr("r",function(a){return a.value}),y.append("text").selectAll("tspan").data(function(a){return a.name.split(" ")}).enter().append("tspan").attr("x",0).attr("y",function(a,b,c){return 18+15*(b-c.length/2-.5)}).attr("fill","#ffffff").attr("text-anchor","middle").text(function(a){return a})}function k(a){y.each(l(.5*r.alpha())).each(m(.5)).attr("cx",function(a){return a[0]}).attr("cy",function(a){return a.y}).attr("transform",function(a){return"translate("+a[0]+","+a[1]+")"})}function l(a){return function(b){var c=b.value+4;b[1]+=(b.cy-b.y)*a,b[0]+=(b.cx-b[0])*a/8,b[0]-c<0?b[0]=c:b[0]+c>t.chart.width&&(b[0]=t.chart.width-c),b[1]-c<0?b[1]=c:b[1]+c>t.chart.height&&(b[1]=t.chart.height-c)}}function m(a){var b=d3.quadtree(w);return function(c){var d=c.value+z.domain()[1]+B,e=c[0]-d,f=c[0]+d,g=c[1]-d,h=c[1]+d;b.visit(function(b,d,i,j,k){if(b.data&&b.data!==c){var l=c[0]-b.data[0],m=c[1]-b.data[1],n=Math.sqrt(l*l+m*m),o=c.value+b.data.value;n<o&&(n=(n-o)/n*a,c[0]-=l*=n,c[1]-=m*=n,b.data[0]+=l,b.data[1]+=m)}return d>f||j<e||i>h||k<g})}}function n(){b.$apply()}function o(a){D&&(q&&f.cancel(q),q=f(function(){t.chart.width=c[0].offsetWidth-t.chart.marginLeft-t.chart.marginRight,t.chart.width<0&&(t.chart.width=0),j()},500))}function p(){angular.element(e).off("resize",n),d3.select(c[0]).select("svg").remove()}var q,r,s={chart:{marginTop:0,marginRight:0,marginBottom:0,marginLeft:0,height:200,radius:{min:20,max:70}}},t=angular.merge(s,b.data),u=this,v=a.brand10(),w=u.nodes=null,x=null,y=null,z=null,A=1,B=100,C=null,D=!1;b.$watch("data",h,!0),b.$on("$destroy",p),c.on("$destroy",p),angular.element(e).on("resize",n),b.$watch(function(){return c[0].offsetWidth},o)}return{restrict:"A",scope:{data:"=?"},link:h}}angular.module("bento.d3").directive("bentoD3BubbleChart",a),a.$inject=["bentoD3Config","$parse","$log","$http","$window","$timeout","bentoChartService"]}();