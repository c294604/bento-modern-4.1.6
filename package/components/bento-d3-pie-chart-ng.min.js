/**
 * Bento v4.1.6
 * Built on: 2024-11-14T22:21:54
 * Copyright 2024 Thomson Reuters
 * Maintained by Chi Gao, Joe Huang, Aaron Mendez
 */
!function(){"use strict";angular.module("bento.d3").directive("bentoD3PieChart",["bentoD3Config","$bentoServices",function(a,b){return{restrict:"EA",scope:{data:"=",index:"=",responsive:"@",onClick:"&",onHover:"&",onLeave:"&"},link:function(c,d,e){function f(a){if(void 0!==a){var b;s.selectAll(".arc").each(function(c,d){d===a?(b=c,d3.select(this).classed("is-faded",!1).classed("is-selected",!0)):a===-1?g():d3.select(this).classed("is-faded",!0).classed("is-selected",!1)}),c.onHover({item:b,index:a}),c.onClick({item:b,index:a})}}function g(){s.selectAll(".arc").classed("is-faded",!1).classed("is-selected",!1),c.onClick({item:{},index:-1})}function h(){var a=s.selectAll(".arc");e.onClick&&a.on("click",null),e.onHover&&a.on("mouseover",null),e.onLeave&&s.on("mouseleave",null)}var i=e.diameter?parseInt(e.diameter):120,j=e.padding?parseInt(e.padding):0,k=i+j,l=i+j,m=i/2,n=a.brand10(),o=e.innerRadius?e.innerRadius:0,p=m+20;e.responsive&&(d[0].className+=" is-responsive");var q=d3.arc().outerRadius(m).innerRadius(o),r=d3.pie().sort(null),s=d3.select(d[0]).append("svg").attr("width",k).attr("height",l).attr("preserveAspectRatio","xMidYMid").attr("viewBox","0 0 "+l+" "+k).append("g").attr("transform","translate("+k/2+","+l/2+")");c.$watchCollection("data",function(a){c.render(a)}),c.$on("$destroy",h),d.on("$destroy",h),c.$watch("index",function(a){f(a)}),c.render=function(a){var d=d3.sum(a,function(a){return a.value});s.selectAll("*").remove();var h=[];a.forEach(function(a){h.push(a.value)});var i=s.selectAll(".arc").data(r(h)).enter().append("g").attr("class","arc");e.onClick&&i.on("click",function(a,b){var d=this,e=b;c.$apply(function(){d3.select(d).classed("is-selected")?g():f(e)})}),e.onHover&&i.on("mouseover",function(a,b){var d=b;c.$apply(function(){f(d)})}),e.onLeave&&s.on("mouseleave",function(){c.$apply(function(){s.selectAll(".arc").classed("is-faded",!1).classed("is-selected",!1),c.onLeave()})}),i.append("path").style("fill",function(b,c){var e=a[c].color||n(c);return a[c].color=e,a[c].percent=Math.round(b.value/d*100,1),e}).attr("d",q),e.labelOutside?i.append("text").attr("transform",function(a){var b=q.centroid(a),c=b[0],d=b[1],e=Math.sqrt(c*c+d*d);return"translate("+c/e*p+","+d/e*p+")"}).attr("class",function(a){var c="end",d="start";return b.isRTL()===!0&&"ie"===b.getBrowser().browser&&(c="start",d="end"),(a.endAngle+a.startAngle)/2>Math.PI?"label-outside "+c:"label-outside "+d}).text(function(b,c){return a[c].label}):i.append("text").attr("transform",function(a){return"translate("+q.centroid(a)+")"}).style("text-anchor","middle").text(function(b,c){return a[c].label})}}}}])}();